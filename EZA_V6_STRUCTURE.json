{
  "version": "6.0.0",
  "project_name": "EZA-Core V6 Enterprise Edition",
  "backend_structure": {
    "root": "eza-v5/backend",
    "main_files": [
      "main.py",
      "config.py",
      "run.py",
      "requirements.txt",
      "Dockerfile"
    ],
    "core_modules": {
      "engines": [
        "alignment_engine.py",
        "deception_engine.py",
        "drift_detector.py",
        "input_analyzer.py",
        "legal_risk.py",
        "model_router.py",
        "output_analyzer.py",
        "psych_pressure.py",
        "redirect_engine.py",
        "safe_rewrite.py",
        "safety_graph.py",
        "score_engine.py"
      ],
      "schemas": [
        "auth.py",
        "standalone.py",
        "user.py"
      ],
      "services": [
        "auth_service.py"
      ],
      "utils": [
        "dependencies.py",
        "queue.py",
        "rate_limit.py",
        "security.py",
        "telemetry.py"
      ]
    },
    "routers": [
      {
        "file": "auth.py",
        "base_path": "/api/auth",
        "tags": ["Authentication"],
        "description": "User authentication endpoints"
      },
      {
        "file": "standalone.py",
        "base_path": "/api/standalone",
        "tags": ["Standalone"],
        "description": "Standalone chat mode"
      },
      {
        "file": "proxy.py",
        "base_path": "/api/proxy",
        "tags": ["Proxy"],
        "description": "Proxy mode (Fast/Deep analysis)"
      },
      {
        "file": "proxy_lite.py",
        "base_path": "/api/proxy-lite",
        "tags": ["Proxy-Lite"],
        "description": "Proxy-Lite mode (regulator view)"
      },
      {
        "file": "admin.py",
        "base_path": "/api/admin",
        "tags": ["Admin"],
        "description": "Admin panel endpoints"
      },
      {
        "file": "media.py",
        "base_path": "/api/media",
        "tags": ["Media"],
        "description": "Media monitoring (skeleton)",
        "status": "not_implemented"
      },
      {
        "file": "autonomy.py",
        "base_path": "/api/autonomy",
        "tags": ["Autonomy"],
        "description": "Autonomy monitoring (skeleton)",
        "status": "not_implemented"
      },
      {
        "file": "institution.py",
        "base_path": "/api/institution",
        "tags": ["Institution"],
        "description": "Multi-tenant institution management",
        "status": "new_v6"
      },
      {
        "file": "gateway.py",
        "base_path": "/api/gateway",
        "tags": ["Gateway"],
        "description": "AI Gateway testing endpoints",
        "status": "new_v6"
      }
    ],
    "models": [
      "user.py",
      "role.py",
      "institution.py",
      "api_key.py",
      "application.py"
    ],
    "new_modules": {
      "tenancy": [
        "resolver.py",
        "permissions.py"
      ],
      "gateway": [
        "router_adapter.py",
        "error_mapping.py",
        "providers/openai_provider.py",
        "providers/anthropic_provider.py",
        "providers/local_llm_provider.py"
      ],
      "regulation": [
        "base_policy.py",
        "policy_packs/rtuk_pack.py",
        "policy_packs/btk_pack.py",
        "policy_packs/eu_ai_pack.py",
        "policy_packs/oecd_pack.py"
      ],
      "telemetry": [
        "logger.py",
        "metrics.py",
        "audit_log.py"
      ],
      "learning": [
        "pattern_store.py"
      ]
    },
    "other_modules": {
      "learning": [
        "extractor.py",
        "statistics.py",
        "trainer.py",
        "vector_store.py"
      ],
      "worker": [
        "deep_tasks.py"
      ],
      "scripts": [
        "init_db.py"
      ]
    }
  },
  "key_features": {
    "multi_tenant": {
      "description": "Multi-institution architecture with tenant isolation",
      "modules": ["tenancy/", "models/institution.py", "models/application.py"],
      "endpoints": ["/api/institution"]
    },
    "ai_gateway": {
      "description": "Multi-LLM provider support (OpenAI, Anthropic, Local)",
      "modules": ["gateway/"],
      "endpoints": ["/api/gateway"],
      "providers": ["openai", "anthropic", "local"]
    },
    "regulation": {
      "description": "Regulation compliance policy packs",
      "modules": ["regulation/"],
      "policy_packs": ["rtuk", "btk", "eu_ai", "oecd"]
    },
    "telemetry": {
      "description": "Structured logging, metrics, and audit trails",
      "modules": ["telemetry/"],
      "features": ["logger", "metrics", "audit_log"]
    },
    "learning": {
      "description": "Pattern storage and learning from high-risk content",
      "modules": ["learning/pattern_store.py"],
      "features": ["pattern_storage", "similarity_search", "risk_based_retrieval"]
    }
  },
  "database_tables": {
    "existing": [
      "users",
      "roles",
      "institutions",
      "api_keys"
    ],
    "new_v6": [
      "applications",
      "audit_logs",
      "patterns"
    ],
    "updates_required": {
      "institutions": ["code"],
      "api_keys": ["application_id", "scopes", "revoked_at"]
    }
  },
  "configuration": {
    "file": "config.py",
    "method": "pydantic_settings",
    "env_file": ".env",
    "key_settings": [
      "DATABASE_URL",
      "REDIS_URL",
      "OPENAI_API_KEY",
      "ANTHROPIC_API_KEY",
      "JWT_SECRET_KEY",
      "DEFAULT_LLM_PROVIDER",
      "DEFAULT_POLICY_PACK"
    ]
  },
  "api_endpoints": {
    "authentication": "/api/auth",
    "standalone": "/api/standalone",
    "proxy": "/api/proxy",
    "proxy_lite": "/api/proxy-lite",
    "admin": "/api/admin",
    "media": "/api/media",
    "autonomy": "/api/autonomy",
    "institution": "/api/institution",
    "gateway": "/api/gateway"
  },
  "verification": {
    "backend_imports": "OK",
    "structure_normalized": "OK",
    "v6_features_implemented": "OK"
  }
}

